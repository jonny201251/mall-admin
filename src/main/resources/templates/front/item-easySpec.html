<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE">
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>
    <title th:text="${title}">商品详情页</title>
    <link rel="icon" href="front/img/favicon.ico">

    <link rel="stylesheet" type="text/css" href="front/css/webbase.css"/>
    <link rel="stylesheet" type="text/css" href="front/css/pages-item.css"/>
    <link rel="stylesheet" type="text/css" href="front/css/pages-zoom.css"/>
    <link rel="stylesheet" type="text/css" href="front/css/widget-cartPanelView.css"/>

    <style type="text/css">
        .goods-intro-list li {
            display: inline-block;
            width: 300px;
        }

        .Ptable {
            margin: 10px 0;
        }

        .Ptable-item {
            padding: 12px 0;
            line-height: 220%;
            color: #999;
            font-size: 12px;
            border-bottom: 1px solid #eee;
        }

        .Ptable-item h3 {
            width: 110px;
            text-align: right;
        }

        .Ptable-item h3, .package-list h3 {
            font-weight: 400;
            font-size: 12px;
            float: left;
        }

        h3 {
            display: block;
            font-size: 1.17em;
            -webkit-margin-before: 1em;
            -webkit-margin-after: 1em;
            -webkit-margin-start: 0px;
            -webkit-margin-end: 0px;
            font-weight: bold;
        }

        .Ptable-item dl {
            margin-left: 110px;
        }

        dl {
            display: block;
            -webkit-margin-before: 1em;
            -webkit-margin-after: 1em;
            -webkit-margin-start: 0px;
            -webkit-margin-end: 0px;
        }

        .Ptable-item dt {
            width: 160px;
            float: left;
            text-align: right;
            padding-right: 5px;
        }

        .Ptable-item dd {
            margin-left: 210px;
        }

        dd {
            display: block;
            -webkit-margin-start: 40px;
        }

        .package-list {
            padding: 12px 0;
            line-height: 220%;
            color: #999;
            font-size: 12px;
            margin-top: -1px;
        }

        .package-list h3 {
            width: 130px;
            text-align: right;
        }

        .package-list p {
            margin-left: 155px;
            padding-right: 50px;
        }
    </style>

</head>

<body>

<!-- 头部栏位 -->
<!--页面顶部，由js动态加载-->
<div id="itemApp">
    <div id="nav-bottom">
        <div class='nav-top'>
            <div class='py-container'>
                <div class='shortcut'>
                    <ul class='fl'>
                        <li class='f-item'>商城欢迎您！</li>
                        <li class="f-item">请
                            <a href="login.html" target="_blank">登录</a>
                            <span>
									<a href="register.html" target="_blank">免费注册</a>
								</span>
                        </li>
                    </ul>
                    <ul class='fr'>
                        <li class='f-item'>我的订单</li>
                        <li class='f-item space'></li>
                        <li class='f-item'><a href='home.html' target='_blank'>我的商城</a></li>
                        <li class='f-item space'></li>
                        <li class='f-item'>商城会员</li>
                        <li class='f-item space'></li>
                        <li class='f-item'>企业采购</li>
                        <li class='f-item space'></li>
                        <li class='f-item'>关注商城</li>
                        <li class='f-item space'></li>
                        <li class='f-item' id='service'>
                            <span>客户服务</span>
                            <ul class='service'>
                                <li><a href='/cooperation.html' target='_blank'>合作招商</a></li>
                                <li><a href='/shoplogin.html' target='_blank'>商家后台</a></li>
                                <li><a href='/cooperation.html' target='_blank'>合作招商</a></li>
                                <li><a href='#'>商家后台</a></li>
                            </ul>
                        </li>
                        <li class='f-item space'></li>
                        <li class='f-item'>网站导航</li>
                    </ul>
                </div>
            </div>
            <!--头部-->
            <div class='header' id='headApp'>
                <div class='py-container'>
                    <div class='yui3-g Logo'>
                        <div class='yui3-u Left logoArea'>
                            <a class='logo-bd' title='商城' href='index.html' target='_blank'></a>
                        </div>
                        <div class='yui3-u Center searchArea'>
                            <div class='search'>
                                <form action='' class='sui-form form-inline'>
                                    <!--searchAutoComplete-->
                                    <div class='input-append'>
                                        <input type='text' id='autocomplete' class='input-error input-xxlarge'/>
                                        <button class='sui-btn btn-xlarge btn-danger' type='button'>搜索</button>
                                    </div>
                                </form>
                            </div>
                            <div class='hotwords'>
                                <ul>
                                    <li class='f-item'>商城首发</li>
                                    <li class='f-item'>亿元优惠</li>
                                    <li class='f-item'>9.9元团购</li>
                                    <li class='f-item'>每满99减30</li>
                                    <li class='f-item'>亿元优惠</li>
                                    <li class='f-item'>9.9元团购</li>
                                    <li class='f-item'>办公用品</li>
                                </ul>
                            </div>
                        </div>
                        <div class='yui3-u Right shopArea'>
                            <div class='fr shopcar'>
                                <div class='show-shopcar' id='shopcar'>
                                    <span class='car'></span>
                                    <a class='sui-btn btn-default btn-xlarge' href='cart.html' target='_blank'>
                                        <span>我的购物车</span>
                                        <i class='shopnum'>0</i>
                                    </a>
                                    <div class='clearfix shopcarlist' id='shopcarlist' style='display:none'>
                                        <p>'啊哦，你的购物车还没有商品哦！'</p>
                                        <p>'啊哦，你的购物车还没有商品哦！'</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class='yui3-g NavList'>
                        <div class='yui3-u Left all-sort'>
                            <h4>商城精品</h4>
                        </div>
                        <div class='yui3-u Center navArea'>
                            <ul class='nav'>
                                <li class='f-item'>服装城</li>
                                <li class='f-item'>美妆馆</li>
                                <li class='f-item'>品优超市</li>
                                <li class='f-item'>全球购</li>
                                <li class='f-item'>闪购</li>
                                <li class='f-item'>团购</li>
                                <li class='f-item'>有趣</li>
                                <li class='f-item'><a href='seckill-index.html' target='_blank'>秒杀</a></li>
                            </ul>
                        </div>
                        <div class='yui3-u Right'></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="py-container">
        <div id="item">
            <div class="crumb-wrap">
                <ul class="sui-breadcrumb">
                    <li th:each="c : ${categories}">
                        <a href="#" th:text="${c.name}">手机</a>
                    </li>
                    <li>
                        <a href="#" th:text="${brand.name}">Apple</a>
                    </li>
                    <li class="active" th:text="${title}">Apple iPhone 6s</li>
                </ul>
            </div>
            <!--product-info-->
            <div class="product-info">
                <div class="fl preview-wrap">
                    <!--放大镜效果-->
                    <div class="zoom">
                        <!--默认第一个预览-->
                        <div id="preview" class="spec-preview">
							<span class="jqzoom">
								<img :jqimg="images[0]" :src="images[0]" width="400px" height="400px"/>
							</span>
                        </div>
                        <!--下方的缩略图-->
                        <div class="spec-scroll">
                            <a class="prev">&lt;</a>
                            <!--左右按钮-->
                            <div class="items">
                                <ul>
                                    <li v-for="img in images">
                                        <img :src="img" :bimg="img" onmousemove="preview(this)"/>
                                    </li>
                                </ul>
                            </div>
                            <a class="next">&gt;</a>
                        </div>
                    </div>
                </div>
                <div class="fr itemInfo-wrap">
                    <div class="sku-name">
                        <h4 v-text="sku.title"></h4>
                    </div>
                    <div class="news"><span th:utext="${subTitle}">Apple iPhone 6s 4GB 128GB 土豪金</span></div>
                    <div class="summary">
                        <div class="summary-wrap">
                            <div class="fl title"><i>价　　格</i></div>
                            <div class="fl price">
                                <i>¥</i><em v-text="sku.price"></em>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix choose">
                        <div class="summary-wrap">
                            <div class="fl title">
                                <div class="control-group">
                                    <div class="controls">
                                        <input autocomplete="off" type="text" disabled v-model="num" minnum="1"
                                               class="itxt"/>
                                        <a href="javascript:void(0)" class="increment plus" @click="increment">+</a>
                                        <a href="javascript:void(0)" class="increment mins" @click="decrement">-</a>
                                    </div>
                                </div>
                            </div>
                            <div class="fl">
                                <ul class="btn-choose unstyled">
                                    <li>
                                        <a href="#" @click.prevent="addCart" target="_blank"
                                           class="sui-btn  btn-danger addshopcar">加入购物车</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--product-detail-->
            <div class="clearfix product-detail">
                <div class="fl aside">
                    <ul class="sui-nav nav-tabs tab-wraped">
                        <li class="active">
                            <a href="#index" data-toggle="tab">
                                <span>相关分类</span>
                            </a>
                        </li>
                        <li>
                            <a href="#profile" data-toggle="tab">
                                <span>推荐品牌</span>
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content tab-wraped">
                        <div id="index" class="tab-pane active">
                            <ul class="part-list unstyled">
                                <li>手机</li>
                                <li>手机壳</li>
                                <li>内存卡</li>
                                <li>Iphone配件</li>
                                <li>贴膜</li>
                                <li>手机耳机</li>
                                <li>移动电源</li>
                                <li>平板电脑</li>
                            </ul>
                            <ul class="goods-list unstyled">
                                <li>
                                    <div class="list-wrap">
                                        <div class="p-img">
                                            <img src="front/img/_/part01.png"/>
                                        </div>
                                        <div class="attr">
                                            <em>Apple苹果iPhone 6s (A1699)</em>
                                        </div>
                                        <div class="price">
                                            <strong>
                                                <em>¥</em>
                                                <i>6088.00</i>
                                            </strong>
                                        </div>
                                        <div class="operate">
                                            <a href="javascript:void(0);" class="sui-btn btn-bordered">加入购物车</a>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="list-wrap">
                                        <div class="p-img">
                                            <img src="front/img/_/part02.png"/>
                                        </div>
                                        <div class="attr">
                                            <em>Apple苹果iPhone 6s (A1699)</em>
                                        </div>
                                        <div class="price">
                                            <strong>
                                                <em>¥</em>
                                                <i>6088.00</i>
                                            </strong>
                                        </div>
                                        <div class="operate">
                                            <a href="javascript:void(0);" class="sui-btn btn-bordered">加入购物车</a>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="list-wrap">
                                        <div class="p-img">
                                            <img src="front/img/_/part03.png"/>
                                        </div>
                                        <div class="attr">
                                            <em>Apple苹果iPhone 6s (A1699)</em>
                                        </div>
                                        <div class="price">
                                            <strong>
                                                <em>¥</em>
                                                <i>6088.00</i>
                                            </strong>
                                        </div>
                                        <div class="operate">
                                            <a href="javascript:void(0);" class="sui-btn btn-bordered">加入购物车</a>
                                        </div>
                                    </div>
                                    <div class="list-wrap">
                                        <div class="p-img">
                                            <img src="front/img/_/part02.png"/>
                                        </div>
                                        <div class="attr">
                                            <em>Apple苹果iPhone 6s (A1699)</em>
                                        </div>
                                        <div class="price">
                                            <strong>
                                                <em>¥</em>
                                                <i>6088.00</i>
                                            </strong>
                                        </div>
                                        <div class="operate">
                                            <a href="javascript:void(0);" class="sui-btn btn-bordered">加入购物车</a>
                                        </div>
                                    </div>
                                    <div class="list-wrap">
                                        <div class="p-img">
                                            <img src="front/img/_/part03.png"/>
                                        </div>
                                        <div class="attr">
                                            <em>Apple苹果iPhone 6s (A1699)</em>
                                        </div>
                                        <div class="price">
                                            <strong>
                                                <em>¥</em>
                                                <i>6088.00</i>
                                            </strong>
                                        </div>
                                        <div class="operate">
                                            <a href="javascript:void(0);" class="sui-btn btn-bordered">加入购物车</a>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <div id="profile" class="tab-pane">
                            <p>推荐品牌</p>
                        </div>
                    </div>
                </div>
                <div class="fr detail">
                    <div class="tab-main intro">
                        <ul class="sui-nav nav-tabs tab-wraped">
                            <li class="active">
                                <a href="#one" data-toggle="tab">
                                    <span>商品详情</span>
                                </a>
                            </li>
                            <li>
                                <a href="#two" data-toggle="tab">
                                    <span>规格参数</span>
                                </a>
                            </li>
                            <li>
                                <a href="#three" data-toggle="tab">
                                    <span>包装售后</span>
                                </a>
                            </li>
                        </ul>
                        <div class="clearfix"></div>
                        <div class="tab-content tab-wraped">
                            <div id="one" class="tab-pane active">
                                <!--商品详情-->
                                <div class="intro-detail" style="text-align: center">
                                    <div th:utext="${detail.description}"></div>
                                </div>
                            </div>
                            <div id="two" class="tab-pane">
                                <div class="Ptable">
                                    <div class="Ptable-item" v-for="param in specGroups" :key="param.id">
                                        <div>
                                            <span v-text="param.name"></span>:
                                            <span v-text="param.value + (param.unit || '')"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="three" class="tab-pane">
                                <p th:text="${detail.afterService}">售后保障</p>
                                <p th:text="${detail.packingList}">包装清单</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class='py-container'>
        <!-- 底部栏位 -->
        <!--页面底部-->
        <div class="clearfix footer">
            <div class="py-container">
                <div class="footlink">
                    <div class="Mod-service">
                        <ul class="Mod-Service-list">
                            <li class="grid-service-item intro  intro1">

                                <i class="serivce-item fl"></i>
                                <div class="service-text">
                                    <h4>正品保障</h4>
                                    <p>正品保障，提供发票</p>
                                </div>

                            </li>
                            <li class="grid-service-item  intro intro2">

                                <i class="serivce-item fl"></i>
                                <div class="service-text">
                                    <h4>正品保障</h4>
                                    <p>正品保障，提供发票</p>
                                </div>

                            </li>
                            <li class="grid-service-item intro  intro3">

                                <i class="serivce-item fl"></i>
                                <div class="service-text">
                                    <h4>正品保障</h4>
                                    <p>正品保障，提供发票</p>
                                </div>

                            </li>
                            <li class="grid-service-item  intro intro4">

                                <i class="serivce-item fl"></i>
                                <div class="service-text">
                                    <h4>正品保障</h4>
                                    <p>正品保障，提供发票</p>
                                </div>

                            </li>
                            <li class="grid-service-item intro intro5">

                                <i class="serivce-item fl"></i>
                                <div class="service-text">
                                    <h4>正品保障</h4>
                                    <p>正品保障，提供发票</p>
                                </div>

                            </li>
                        </ul>
                    </div>
                    <div class="clearfix Mod-list">
                        <div class="yui3-g">
                            <div class="yui3-u-1-6">
                                <h4>购物指南</h4>
                                <ul class="unstyled">
                                    <li>购物流程</li>
                                    <li>会员介绍</li>
                                    <li>生活旅行/团购</li>
                                    <li>常见问题</li>
                                    <li>购物指南</li>
                                </ul>

                            </div>
                            <div class="yui3-u-1-6">
                                <h4>配送方式</h4>
                                <ul class="unstyled">
                                    <li>上门自提</li>
                                    <li>211限时达</li>
                                    <li>配送服务查询</li>
                                    <li>配送费收取标准</li>
                                    <li>海外配送</li>
                                </ul>
                            </div>
                            <div class="yui3-u-1-6">
                                <h4>支付方式</h4>
                                <ul class="unstyled">
                                    <li>货到付款</li>
                                    <li>在线支付</li>
                                    <li>分期付款</li>
                                    <li>邮局汇款</li>
                                    <li>公司转账</li>
                                </ul>
                            </div>
                            <div class="yui3-u-1-6">
                                <h4>售后服务</h4>
                                <ul class="unstyled">
                                    <li>售后政策</li>
                                    <li>价格保护</li>
                                    <li>退款说明</li>
                                    <li>返修/退换货</li>
                                    <li>取消订单</li>
                                </ul>
                            </div>
                            <div class="yui3-u-1-6">
                                <h4>特色服务</h4>
                                <ul class="unstyled">
                                    <li>夺宝岛</li>
                                    <li>DIY装机</li>
                                    <li>延保服务</li>
                                    <li>品优购E卡</li>
                                    <li>品优购通信</li>
                                </ul>
                            </div>
                            <div class="yui3-u-1-6">
                                <h4>帮助中心</h4>
                                <img src="front/img/wx_cz.jpg">
                            </div>
                        </div>
                    </div>
                    <div class="Mod-copyright">
                        <ul class="helpLink">
                            <li>关于我们
                                <span class="space"></span>
                            </li>
                            <li>联系我们
                                <span class="space"></span>
                            </li>
                            <li>关于我们
                                <span class="space"></span>
                            </li>
                            <li>商家入驻
                                <span class="space"></span>
                            </li>
                            <li>营销中心
                                <span class="space"></span>
                            </li>
                            <li>友情链接
                                <span class="space"></span>
                            </li>
                            <li>关于我们
                                <span class="space"></span>
                            </li>
                            <li>营销中心
                                <span class="space"></span>
                            </li>
                            <li>友情链接
                                <span class="space"></span>
                            </li>
                            <li>关于我们</li>
                        </ul>
                        <p>地址：北京市丰台区云岗西路7号 邮编：100096 电话：400-618-4000 传真：010-82935100</p>
                        <p>京ICP备08001421号京公网安备110108007702</p>
                    </div>
                </div>
            </div>
        </div>
        <!--页面底部END-->
    </div>
</div>
<script src="front/js/vue/vue.js"></script>
<script src="front/js/axios.min.js"></script>
<script src="front/js/common.js"></script>

<script th:inline="javascript">
    const specialSpec = [];
    const genericSpec = JSON.parse(/*[[${detail.genericSpec}]]*/ "");
    const skus = /*[[${skus}]]*/ [];
    const specs = /*[[${specs}]]*/ [];
</script>
<script>
    var itemVm = new Vue({
        el: "#itemApp",
        data: {
            ly,
            num: 1,
        },
        methods: {
            decrement() {
                if (this.num > 1) {
                    this.num--;
                }
            },
            increment() {
                this.num++;
            },
            addCart() {
                // 判断是否登录
                ly.http.get("/auth/verify").then(() => {
                    // 已登录
                    ly.http.post("/cart", {
                        skuId: this.sku.id,
                        title: this.sku.title,
                        image: this.images[0],
                        price: this.sku.price,
                        num: this.num,
                        skuSpec: JSON.stringify(this.skuSpec)
                    }).then(() => {
                        // 跳转到购物车列表页
                        window.location.href = "http://www.leyou.com/cart.html";
                    }).catch(() => {
                        alert("添加购物车失败，请重试！");
                    })
                }).catch(() => {
                    // 获取以前的购物车
                    const carts = ly.store.get("carts") || [];
                    // 获取与当前商品id一致的购物车数据
                    const cart = carts.find(c => c.skuId === this.sku.id);
                    if (cart) {
                        // 存在，修改数量
                        cart.num += this.num;
                    } else {
                        // 不存在，新增
                        carts.push({
                            skuId: this.sku.id,
                            title: this.sku.title,
                            image: this.images[0],
                            price: this.sku.price,
                            num: this.num,
                            skuSpec: JSON.stringify(this.skuSpec)
                        })
                    }
                    // 未登录
                    ly.store.set("carts", carts);
                    // 跳转到购物车列表页
                    window.location.href = "http://www.leyou.com/cart.html";
                })
            },
            locked(id, i) {
                // 如果只有一个可选项，永不锁定
                if (specialSpec[id].length === 1) return false;
                // 如果有其它项未选，不锁定
                let boo = true;
                Object.keys(this.indexes).forEach(key => {
                    if (key !== id && this.indexes[key] == null) {
                        boo = false;
                        return;
                    }
                });
                if (!boo) return false;
                // 如果当前项的组合不存在，锁定
                const {...o} = this.indexes;
                o[id] = i;
                const index = Object.values(o).join("_");
                return !indexArr.includes(index);
            }
        },
        computed: {
            sku() {
                return skus[0];
            },
            images() {
                return this.sku.images ? this.sku.images.split(",") : [];
            },
            specGroups() {
                // 获取-通用规格参数值
                specs.forEach(param => {
                    param.value = genericSpec[param.id];

                })
                return specs;
            }
        }
    });
</script>

<script type="text/javascript" src="front/js/plugins/jquery/jquery.min.js"></script>
<script type="text/javascript">
    $(function () {
        $("#service").hover(function () {
            $(".service").show();
        }, function () {
            $(".service").hide();
        });
        $("#shopcar").hover(function () {
            $("#shopcarlist").show();
        }, function () {
            $("#shopcarlist").hide();
        });
    })
</script>
<script type="text/javascript" src="front/js/model/cartModel.js"></script>
<script type="text/javascript" src="front/js/plugins/jquery.easing/jquery.easing.min.js"></script>
<script type="text/javascript" src="front/js/plugins/sui/sui.min.js"></script>
<script type="text/javascript" src="front/js/plugins/jquery.jqzoom/jquery.jqzoom.js"></script>
<script type="text/javascript" src="front/js/plugins/jquery.jqzoom/zoom.js"></script>
</body>

</html>